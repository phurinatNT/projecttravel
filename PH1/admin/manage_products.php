<?php require '../includes/auth.php'; require '../includes/db.php'; require '../includes/header.php'; if($_SESSION['role']!=='admin'){ header('Location: dashboard.php'); exit(); } if($_SERVER['REQUEST_METHOD']==='POST' && isset($_POST['add'])){ $name=$_POST['name']; $desc=$_POST['description']; $price=(float)$_POST['price']; $img=$_POST['image']?:'assets/img/product1.jpg'; $stmt=$conn->prepare('INSERT INTO products (province_id,name,description,price,image) VALUES (1,?,?,?,?)'); $stmt->bind_param('ssds',$name,$desc,$price,$img); $stmt->execute(); } if(isset($_GET['delete'])){ $id=(int)$_GET['delete']; $s=$conn->prepare('DELETE FROM products WHERE id=?'); $s->bind_param('i',$id); $s->execute(); } $products=$conn->query('SELECT * FROM products'); ?>
<div class="card"><h3>จัดการสินค้า</h3><form method="post" style="display:grid;grid-template-columns:1fr 1fr;gap:8px"><input name="name" placeholder="ชื่อสินค้า" required><input name="price" placeholder="ราคา" type="number" step="0.01"><input name="image" placeholder="path to image"><textarea name="description" placeholder="รายละเอียด" style="grid-column:1/3"></textarea><div style="grid-column:1/3"><button class="btn" name="add" type="submit">เพิ่มสินค้า</button></div></form><hr><h4>รายการ</h4><?php while($p=$products->fetch_assoc()){ echo '<div class="list-item"><img src="'.e($p['image']?:'assets/img/product1.jpg').'">'; echo '<div><strong>'.e($p['name']).'</strong><br><small>'.e($p['price']).' บาท</small><br><a href="?delete='.$p['id'].'" onclick="return confirm(\'ลบ?\')">ลบ</a></div></div>'; } ?></div><?php require '../includes/footer.php'; ?>